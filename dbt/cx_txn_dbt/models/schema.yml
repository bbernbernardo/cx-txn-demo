version: 2

models:
  - name: stg_customer_transactions
    description: "Staging model that cleans and casts raw customer transactions"
    columns:
      - name: transaction_id
        tests: [not_null, unique]
      - name: customer_id
        tests: [not_null]
      - name: product_id
        tests: [not_null]
      - name: transaction_date
        tests: [not_null]

  - name: dim_customer
    description: "Customer dimension"
    columns:
      - name: customer_id
        tests: [not_null, unique]

  - name: dim_product
    description: "Product dimension"
    columns:
      - name: product_id
        tests: [not_null, unique]

  - name: dim_date
    description: "Date dimension table generated from date range"
    columns:
      - name: date_id
        tests: [not_null, unique]

  - name: fact_customer_transactions
    description: "Fact table capturing transactional measures"
    columns:
      - name: transaction_id
        tests: [not_null, unique]
      - name: total_amount
        tests: [not_null]
        
  # TO DO: Add dbt expectations
  # - name: stg_customer_transactions
  #   description: "Cleaned transactions with consistent data types"
  #   columns:
  #     - name: customer_id
  #       tests: [not_null]
  #     - name: product_id
  #       tests: [not_null]
  #     - name: transaction_date
  #       tests: [not_null]
  #     - name: transaction_id
  #       tests: [not_null, unique]
  #     - name: price
  #       tests:
  #         - not_null
  #         - dbt_expectations.expect_column_values_to_be_between:
  #             min_value: 0
  #     - name: tax
  #       tests:
  #         - not_null
  #         - dbt_expectations.expect_column_values_to_be_between:
  #             min_value: 0
